!function(){"use strict";function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function e(t,e){return e={exports:{}},t(e,e.exports),e.exports}function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new AFRAME.THREE.FileLoader;return new qe(function(n,r){e.load(t,n,function(){},r)})}function r(t,e){var n=new pn(t),r=!0,i=!1,o=void 0;try{for(var a,s=Ke(e);!(r=(a=s.next()).done);r=!0){var u=a.value;n.delete(u)}}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}function i(t,e){e.decompose(vn,yn,gn),t.setAttribute("position",vn),t.setAttribute("quaternion",yn),t.setAttribute("scale",gn)}function o(){function t(t,e){console.log("Attempting to get controllers"),(mn=altspace.getGamepads()).length>0?(console.log("Got controllers"),t(mn.filter(function(t){return!!t.hand}))):e()}function e(t,e){function n(){r.removeEventListener("click",n),t()}var r=document.querySelector("a-scene");console.log("waiting for focus"),r.addEventListener("click",n)}function n(e){return new qe(t).catch(function(){if(--e>0)return new qe(function(t,e){return setTimeout(t,500)}).then(function(){return n(e)});console.log("Failed to get controllers")})}return altspace.inClient?new qe(t).catch(function(){return new qe(e)}).then(function(){return n(20)}):qe.reject()}var a=e(function(t){!function(e){function n(t,e,n,o){var a=e&&e.prototype instanceof i?e:i,s=Object.create(a.prototype),u=new h(o||[]);return s._invoke=function(t,e,n){var i=A;return function(o,a){if(i===S)throw new Error("Generator is already running");if(i===M){if("throw"===o)throw a;return p()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=c(s,n);if(u){if(u===j)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===A)throw i=M,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=S;var l=r(t,e,n);if("normal"===l.type){if(i=n.done?M:x,l.arg===j)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=M,n.method="throw",n.arg=l.arg)}}}(t,n,u),s}function r(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function i(){}function o(){}function a(){}function s(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function u(t){function e(n,i,o,a){var s=r(t[n],t,i);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==typeof c&&g.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,o,a)},function(t){e("throw",t,o,a)}):Promise.resolve(c).then(function(t){u.value=t,o(u)},a)}a(s.arg)}var n;this._invoke=function(t,r){function i(){return new Promise(function(n,i){e(t,r,n,i)})}return n=n?n.then(i,i):i()}}function c(t,e){var n=t.iterator[e.method];if(n===v){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=v,c(t,e),"throw"===e.method))return j;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return j}var i=r(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,j;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=v),e.delegate=null,j):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,j)}function l(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function f(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function h(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(l,this),this.reset(!0)}function d(t){if(t){var e=t[b];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(g.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=v,e.done=!0,e};return r.next=r}}return{next:p}}function p(){return{value:v,done:!0}}var v,y=Object.prototype,g=y.hasOwnProperty,m="function"==typeof Symbol?Symbol:{},b=m.iterator||"@@iterator",w=m.asyncIterator||"@@asyncIterator",_=m.toStringTag||"@@toStringTag",E=e.regeneratorRuntime;if(E)t.exports=E;else{(E=e.regeneratorRuntime=t.exports).wrap=n;var A="suspendedStart",x="suspendedYield",S="executing",M="completed",j={},T={};T[b]=function(){return this};var L=Object.getPrototypeOf,k=L&&L(L(d([])));k&&k!==y&&g.call(k,b)&&(T=k);var O=a.prototype=i.prototype=Object.create(T);o.prototype=O.constructor=a,a.constructor=o,a[_]=o.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(O),t},E.awrap=function(t){return{__await:t}},s(u.prototype),u.prototype[w]=function(){return this},E.AsyncIterator=u,E.async=function(t,e,r,i){var o=new u(n(t,e,r,i));return E.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},s(O),O[_]="Generator",O[b]=function(){return this},O.toString=function(){return"[object Generator]"},E.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},E.values=d,h.prototype={constructor:h,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=v,this.done=!1,this.delegate=null,this.method="next",this.arg=v,this.tryEntries.forEach(f),!t)for(var e in this)"t"===e.charAt(0)&&g.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=v)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){function e(e,r){return o.type="throw",o.arg=t,n.next=e,r&&(n.method="next",n.arg=v),!!r}if(this.done)throw t;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=g.call(i,"catchLoc"),s=g.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&g.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,j):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),j},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),f(n),j}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;f(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:d(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=v),j}}}}(function(){return this}()||Function("return this")())}),s=function(){return this}()||Function("return this")(),u=s.regeneratorRuntime&&Object.getOwnPropertyNames(s).indexOf("regeneratorRuntime")>=0,c=u&&s.regeneratorRuntime;s.regeneratorRuntime=void 0;var l=a;if(u)s.regeneratorRuntime=c;else try{delete s.regeneratorRuntime}catch(t){s.regeneratorRuntime=void 0}var f=l,h=Math.ceil,d=Math.floor,p=function(t){return isNaN(t=+t)?0:(t>0?d:h)(t)},v=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},y=e(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),g=e(function(t){var e=t.exports={version:"2.5.3"};"number"==typeof __e&&(__e=e)}),m=(g.version,function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}),b=function(t,e,n){if(m(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},w=function(t){return"object"==typeof t?null!==t:"function"==typeof t},_=function(t){if(!w(t))throw TypeError(t+" is not an object!");return t},E=function(t){try{return!!t()}catch(t){return!0}},A=!E(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),x=y.document,S=w(x)&&w(x.createElement),M=function(t){return S?x.createElement(t):{}},j=!A&&!E(function(){return 7!=Object.defineProperty(M("div"),"a",{get:function(){return 7}}).a}),T=Object.defineProperty,L={f:A?Object.defineProperty:function(t,e,n){if(_(t),e=function(t,e){if(!w(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!w(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!w(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!w(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),_(n),j)try{return T(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},k=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},O=A?function(t,e,n){return L.f(t,e,k(1,n))}:function(t,e,n){return t[e]=n,t},R="prototype",F=function(t,e,n){var r,i,o,a=t&F.F,s=t&F.G,u=t&F.S,c=t&F.P,l=t&F.B,f=t&F.W,h=s?g:g[e]||(g[e]={}),d=h[R],p=s?y:u?y[e]:(y[e]||{})[R];s&&(n=e);for(r in n)(i=!a&&p&&void 0!==p[r])&&r in h||(o=i?p[r]:n[r],h[r]=s&&"function"!=typeof p[r]?n[r]:l&&i?b(o,y):f&&p[r]==o?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e[R]=t[R],e}(o):c&&"function"==typeof o?b(Function.call,o):o,c&&((h.virtual||(h.virtual={}))[r]=o,t&F.R&&d&&!d[r]&&O(d,r,o)))};F.F=1,F.G=2,F.S=4,F.P=8,F.B=16,F.W=32,F.U=64,F.R=128;var P=F,C=O,D={}.hasOwnProperty,B=function(t,e){return D.call(t,e)},I={},N={}.toString,G=function(t){return N.call(t).slice(8,-1)},W=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==G(t)?t.split(""):Object(t)},z=function(t){return W(v(t))},H=Math.min,V=function(t){return t>0?H(p(t),9007199254740991):0},q=Math.max,U=Math.min,Q="__core-js_shared__",J=y[Q]||(y[Q]={}),K=function(t){return J[t]||(J[t]={})},Y=0,X=Math.random(),Z=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++Y+X).toString(36))},$=K("keys"),tt=function(t){return $[t]||($[t]=Z(t))},et=function(t){return function(e,n,r){var i,o=z(e),a=V(o.length),s=function(t,e){return(t=p(t))<0?q(t+e,0):U(t,e)}(r,a);if(t&&n!=n){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((t||s in o)&&o[s]===n)return t||s||0;return!t&&-1}}(!1),nt=tt("IE_PROTO"),rt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),it=Object.keys||function(t){return function(t,e){var n,r=z(t),i=0,o=[];for(n in r)n!=nt&&B(r,n)&&o.push(n);for(;e.length>i;)B(r,n=e[i++])&&(~et(o,n)||o.push(n));return o}(t,rt)},ot=A?Object.defineProperties:function(t,e){_(t);for(var n,r=it(e),i=r.length,o=0;i>o;)L.f(t,n=r[o++],e[n]);return t},at=y.document,st=at&&at.documentElement,ut=tt("IE_PROTO"),ct=function(){},lt="prototype",ft=function(){var t,e=M("iframe"),n=rt.length;for(e.style.display="none",st.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ft=t.F;n--;)delete ft[lt][rt[n]];return ft()},ht=Object.create||function(t,e){var n;return null!==t?(ct[lt]=_(t),n=new ct,ct[lt]=null,n[ut]=t):n=ft(),void 0===e?n:ot(n,e)},dt=e(function(t){var e=K("wks"),n=y.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:Z)("Symbol."+t))}).store=e}),pt=L.f,vt=dt("toStringTag"),yt=function(t,e,n){t&&!B(t=n?t:t.prototype,vt)&&pt(t,vt,{configurable:!0,value:e})},gt={};O(gt,dt("iterator"),function(){return this});var mt=function(t){return Object(v(t))},bt=tt("IE_PROTO"),wt=Object.prototype,_t=Object.getPrototypeOf||function(t){return t=mt(t),B(t,bt)?t[bt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?wt:null},Et=dt("iterator"),At=!([].keys&&"next"in[].keys()),xt="values",St=function(){return this},Mt=function(t,e,n,r,i,o,a){!function(t,e,n){t.prototype=ht(gt,{next:k(1,n)}),yt(t,e+" Iterator")}(n,e,r);var s,u,c,l=function(t){if(!At&&t in p)return p[t];switch(t){case"keys":case xt:return function(){return new n(this,t)}}return function(){return new n(this,t)}},f=e+" Iterator",h=i==xt,d=!1,p=t.prototype,v=p[Et]||p["@@iterator"]||i&&p[i],y=!At&&v||l(i),g=i?h?l("entries"):y:void 0,m="Array"==e?p.entries||v:v;if(m&&(c=_t(m.call(new t)))!==Object.prototype&&c.next&&yt(c,f,!0),h&&v&&v.name!==xt&&(d=!0,y=function(){return v.call(this)}),a&&(At||d||!p[Et])&&O(p,Et,y),I[e]=y,I[f]=St,i)if(s={values:h?y:l(xt),keys:o?y:l("keys"),entries:g},a)for(u in s)u in p||C(p,u,s[u]);else P(P.P+P.F*(At||d),e,s);return s},jt=function(t){return function(e,n){var r,i,o=String(v(e)),a=p(n),s=o.length;return a<0||a>=s?t?"":void 0:(r=o.charCodeAt(a))<55296||r>56319||a+1===s||(i=o.charCodeAt(a+1))<56320||i>57343?t?o.charAt(a):r:t?o.slice(a,a+2):i-56320+(r-55296<<10)+65536}}(!0);Mt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=jt(e,n),this._i+=t.length,{value:t,done:!1})});var Tt=function(t,e){return{value:e,done:!!t}};Mt(Array,"Array",function(t,e){this._t=z(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,Tt(1)):"keys"==e?Tt(0,n):"values"==e?Tt(0,t[n]):Tt(0,[n,t[n]])},"values");I.Arguments=I.Array;for(var Lt=dt("toStringTag"),kt="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Ot=0;Ot<kt.length;Ot++){var Rt=kt[Ot],Ft=y[Rt],Pt=Ft&&Ft.prototype;Pt&&!Pt[Lt]&&O(Pt,Lt,Rt),I[Rt]=I.Array}var Ct,Dt,Bt,It=dt("toStringTag"),Nt="Arguments"==G(function(){return arguments}()),Gt=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),It))?n:Nt?G(e):"Object"==(r=G(e))&&"function"==typeof e.callee?"Arguments":r},Wt=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t},zt=function(t,e,n,r){try{return r?e(_(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&_(i.call(t)),e}},Ht=dt("iterator"),Vt=Array.prototype,qt=function(t){return void 0!==t&&(I.Array===t||Vt[Ht]===t)},Ut=dt("iterator"),Qt=g.getIteratorMethod=function(t){if(void 0!=t)return t[Ut]||t["@@iterator"]||I[Gt(t)]},Jt=e(function(t){var e={},n={},r=t.exports=function(t,r,i,o,a){var s,u,c,l,f=a?function(){return t}:Qt(t),h=b(i,o,r?2:1),d=0;if("function"!=typeof f)throw TypeError(t+" is not iterable!");if(qt(f)){for(s=V(t.length);s>d;d++)if((l=r?h(_(u=t[d])[0],u[1]):h(t[d]))===e||l===n)return l}else for(c=f.call(t);!(u=c.next()).done;)if((l=zt(c,h,u.value,r))===e||l===n)return l};r.BREAK=e,r.RETURN=n}),Kt=dt("species"),Yt=function(t,e){var n,r=_(t).constructor;return void 0===r||void 0==(n=_(r)[Kt])?e:m(n)},Xt=y.process,Zt=y.setImmediate,$t=y.clearImmediate,te=y.MessageChannel,ee=y.Dispatch,ne=0,re={},ie="onreadystatechange",oe=function(){var t=+this;if(re.hasOwnProperty(t)){var e=re[t];delete re[t],e()}},ae=function(t){oe.call(t.data)};Zt&&$t||(Zt=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return re[++ne]=function(){!function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}t.apply(n,e)}("function"==typeof t?t:Function(t),e)},Ct(ne),ne},$t=function(t){delete re[t]},"process"==G(Xt)?Ct=function(t){Xt.nextTick(b(oe,t,1))}:ee&&ee.now?Ct=function(t){ee.now(b(oe,t,1))}:te?(Bt=(Dt=new te).port2,Dt.port1.onmessage=ae,Ct=b(Bt.postMessage,Bt,1)):y.addEventListener&&"function"==typeof postMessage&&!y.importScripts?(Ct=function(t){y.postMessage(t+"","*")},y.addEventListener("message",ae,!1)):Ct=ie in M("script")?function(t){st.appendChild(M("script"))[ie]=function(){st.removeChild(this),oe.call(t)}}:function(t){setTimeout(b(oe,t,1),0)});var se={set:Zt,clear:$t},ue=se.set,ce=y.MutationObserver||y.WebKitMutationObserver,le=y.process,fe=y.Promise,he="process"==G(le),de={f:function(t){return new function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=m(e),this.reject=m(n)}(t)}},pe=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},ve=function(t,e){if(_(t),w(e)&&e.constructor===t)return e;var n=de.f(t);return(0,n.resolve)(e),n.promise},ye=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:O(t,r,e[r]);return t},ge=dt("species"),me=function(t){var e="function"==typeof g[t]?g[t]:y[t];A&&e&&!e[ge]&&L.f(e,ge,{configurable:!0,get:function(){return this}})},be=dt("iterator"),we=!1;try{[7][be]().return=function(){we=!0}}catch(t){}var _e,Ee,Ae,xe,Se=function(t,e){if(!e&&!we)return!1;var n=!1;try{var r=[7],i=r[be]();i.next=function(){return{done:n=!0}},r[be]=function(){return i},t(r)}catch(t){}return n},Me=se.set,je=function(){var t,e,n,r=function(){var r,i;for(he&&(r=le.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(he)n=function(){le.nextTick(r)};else if(!ce||y.navigator&&y.navigator.standalone)if(fe&&fe.resolve){var i=fe.resolve();n=function(){i.then(r)}}else n=function(){ue.call(y,r)};else{var o=!0,a=document.createTextNode("");new ce(r).observe(a,{characterData:!0}),n=function(){a.data=o=!o}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}(),Te="Promise",Le=y.TypeError,ke=y.process,Oe=y[Te],Re="process"==Gt(ke),Fe=function(){},Pe=Ee=de.f,Ce=!!function(){try{var t=Oe.resolve(1),e=(t.constructor={})[dt("species")]=function(t){t(Fe,Fe)};return(Re||"function"==typeof PromiseRejectionEvent)&&t.then(Fe)instanceof e}catch(t){}}(),De=function(t){var e;return!(!w(t)||"function"!=typeof(e=t.then))&&e},Be=function(t,e){if(!t._n){t._n=!0;var n=t._c;je(function(){for(var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a=i?e.ok:e.fail,s=e.resolve,u=e.reject,c=e.domain;try{a?(i||(2==t._h&&Ge(t),t._h=1),!0===a?n=r:(c&&c.enter(),n=a(r),c&&c.exit()),n===e.promise?u(Le("Promise-chain cycle")):(o=De(n))?o.call(n,s,u):s(n)):u(r)}catch(t){u(t)}};n.length>o;)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&Ie(t)})}},Ie=function(t){Me.call(y,function(){var e,n,r,i=t._v,o=Ne(t);if(o&&(e=pe(function(){Re?ke.emit("unhandledRejection",i,t):(n=y.onunhandledrejection)?n({promise:t,reason:i}):(r=y.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=Re||Ne(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},Ne=function(t){return 1!==t._h&&0===(t._a||t._c).length},Ge=function(t){Me.call(y,function(){var e;Re?ke.emit("rejectionHandled",t):(e=y.onrejectionhandled)&&e({promise:t,reason:t._v})})},We=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),Be(e,!0))},ze=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw Le("Promise can't be resolved itself");(e=De(t))?je(function(){var r={_w:n,_d:!1};try{e.call(t,b(ze,r,1),b(We,r,1))}catch(t){We.call(r,t)}}):(n._v=t,n._s=1,Be(n,!1))}catch(t){We.call({_w:n,_d:!1},t)}}};Ce||(Oe=function(t){Wt(this,Oe,Te,"_h"),m(t),_e.call(this);try{t(b(ze,this,1),b(We,this,1))}catch(t){We.call(this,t)}},(_e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=ye(Oe.prototype,{then:function(t,e){var n=Pe(Yt(this,Oe));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=Re?ke.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Be(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),Ae=function(){var t=new _e;this.promise=t,this.resolve=b(ze,t,1),this.reject=b(We,t,1)},de.f=Pe=function(t){return t===Oe||t===xe?new Ae(t):Ee(t)}),P(P.G+P.W+P.F*!Ce,{Promise:Oe}),yt(Oe,Te),me(Te),xe=g[Te],P(P.S+P.F*!Ce,Te,{reject:function(t){var e=Pe(this);return(0,e.reject)(t),e.promise}}),P(P.S+!0*P.F,Te,{resolve:function(t){return ve(this===xe?Oe:this,t)}}),P(P.S+P.F*!(Ce&&Se(function(t){Oe.all(t).catch(Fe)})),Te,{all:function(t){var e=this,n=Pe(e),r=n.resolve,i=n.reject,o=pe(function(){var n=[],o=0,a=1;Jt(t,!1,function(t){var s=o++,u=!1;n.push(void 0),a++,e.resolve(t).then(function(t){u||(u=!0,n[s]=t,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=Pe(e),r=n.reject,i=pe(function(){Jt(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}}),P(P.P+P.R,"Promise",{finally:function(t){var e=Yt(this,g.Promise||y.Promise),n="function"==typeof t;return this.then(n?function(n){return ve(e,t()).then(function(){return n})}:t,n?function(n){return ve(e,t()).then(function(){throw n})}:t)}}),P(P.S,"Promise",{try:function(t){var e=de.f(this),n=pe(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}});var He=g.Promise,Ve=e(function(t){t.exports={default:He,__esModule:!0}}),qe=t(Ve),Ue=t(e(function(t,e){e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(Ve);e.default=function(t){return function(){var e=t.apply(this,arguments);return new n.default(function(t,r){function i(o,a){try{var s=e[o](a),u=s.value}catch(t){return void r(t)}if(!s.done)return n.default.resolve(u).then(function(t){i("next",t)},function(t){i("throw",t)});t(u)}return i("next")})}}}));AFRAME.registerComponent("place-for-space",{schema:{templates:{default:[]},mixins:{default:[]},otherwise:{default:""}},init:function(){var t=Ue(f.mark(function t(){var e,n;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!altspace.inClient){t.next=6;break}return t.next=3,altspace.getSpace();case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0={};case 7:e=t.t0,console.log(e),(n=this.data.templates.indexOf(e.templateSid))>=0?this.el.setAttribute("mixin",this.data.mixins[n]):this.el.setAttribute("mixin",this.data.otherwise);case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}),AFRAME.registerComponent("library-page",{schema:{service:{type:"string",default:"poly"},page:{type:"int",default:0}},update:function(){var t=Ue(f.mark(function t(e){var n;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.el.emit("pageupdatestart"),t.prev=1,n=this.el.sceneEl.hasAttribute("debug")?"fakeGetListing":"getListing",t.next=5,this.el.sceneEl.systems[this.data.service+"-service"][n](this.data.page);case 5:this.currentPage=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0.stack);case 11:this.el.emit("pageupdateend");case 12:case"end":return t.stop()}},t,this,[[1,8]])}));return function(e){return t.apply(this,arguments)}}()}),AFRAME.registerComponent("library-item",{schema:{type:"int"},init:function(){this.itemData=null,this.el.parentElement.addEventListener("pageupdatestart",this.showLoading.bind(this)),this.el.parentElement.addEventListener("pageupdateend",this.updateContents.bind(this)),this.el.addEventListener("materialtextureloaded",this.updateDimensions.bind(this)),this.el.addEventListener("click",this.previewItem.bind(this))},showLoading:function(){this.el.setAttribute("color","#555")},updateContents:function(){this.itemData=this.el.parentElement.components["library-page"].currentPage.assets[this.data],this.itemData&&this.el.setAttribute("src",this.itemData.thumbnail.url)},updateDimensions:function(){var t=this.el.object3DMap.mesh.material.map,e=t&&t.image&&"IMG"===t.image.tagName?t.image:{width:1,height:1},n=e.width/e.height;n>1?this.el.setAttribute("scale",{x:1,y:1/n,z:1}):this.el.setAttribute("scale",{x:n,y:1,z:1}),this.itemData&&this.el.setAttribute("color","#fff")},previewItem:function(){var t=document.querySelector("#spawn"),e=this.itemData.formats.filter(function(t){return"GLTF2"===t.formatType});t.setAttribute("gltf-model",e[0].root.url)}}),AFRAME.registerComponent("library-advance",{schema:{type:"int"},init:function(){this.active=!1,this.el.addEventListener("click",this.advance.bind(this)),this.el.parentElement.addEventListener("pageupdateend",this.updatePaging.bind(this))},advance:function(){if(this.active){var t=this.el.parentElement,e=t.getAttribute("library-page").page;t.setAttribute("library-page","page",e+this.data)}},updatePaging:function(){var t=this.el.parentElement.components["library-page"];this.el.sceneEl.systems["poly-service"].pages[t.data.page+this.data]||this.data>0&&t.currentPage.nextPageToken?(this.el.setAttribute("avr-visible",!0),this.active=!0,console.log("advance "+this.data+": shown")):(this.el.setAttribute("avr-visible",!1),this.active=!1,console.log("advance "+this.data+": hidden"))}});var Qe=g.getIterator=function(t){var e=Qt(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return _(e.call(t))},Je=e(function(t){t.exports={default:Qe,__esModule:!0}}),Ke=t(Je),Ye=e(function(t){var e=Z("meta"),n=L.f,r=0,i=Object.isExtensible||function(){return!0},o=!E(function(){return i(Object.preventExtensions({}))}),a=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},s=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!w(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!B(t,e)){if(!i(t))return"F";if(!n)return"E";a(t)}return t[e].i},getWeak:function(t,n){if(!B(t,e)){if(!i(t))return!0;if(!n)return!1;a(t)}return t[e].w},onFreeze:function(t){return o&&s.NEED&&i(t)&&!B(t,e)&&a(t),t}}}),Xe=(Ye.KEY,Ye.NEED,Ye.fastKey,Ye.getWeak,Ye.onFreeze,function(t,e){if(!w(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}),Ze=L.f,$e=Ye.fastKey,tn=A?"_s":"size",en=function(t,e){var n,r=$e(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n},nn={getConstructor:function(t,e,n,r){var i=t(function(t,o){Wt(t,i,e,"_i"),t._t=e,t._i=ht(null),t._f=void 0,t._l=void 0,t[tn]=0,void 0!=o&&Jt(o,n,t[r],t)});return ye(i.prototype,{clear:function(){for(var t=Xe(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[tn]=0},delete:function(t){var n=Xe(this,e),r=en(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[tn]--}return!!r},forEach:function(t){Xe(this,e);for(var n,r=b(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!en(Xe(this,e),t)}}),A&&Ze(i.prototype,"size",{get:function(){return Xe(this,e)[tn]}}),i},def:function(t,e,n){var r,i,o=en(t,e);return o?o.v=n:(t._l=o={i:i=$e(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[tn]++,"F"!==i&&(t._i[i]=o)),t},getEntry:en,setStrong:function(t,e,n){Mt(t,e,function(t,n){this._t=Xe(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?"keys"==t?Tt(0,e.k):"values"==t?Tt(0,e.v):Tt(0,[e.k,e.v]):(this._t=void 0,Tt(1))},n?"entries":"values",!n,!0),me(e)}},rn=Array.isArray||function(t){return"Array"==G(t)},on=dt("species"),an=function(t,e){return new(function(t){var e;return rn(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!rn(e.prototype)||(e=void 0),w(e)&&null===(e=e[on])&&(e=void 0)),void 0===e?Array:e}(t))(e)},sn=L.f,un=function(t,e){var n=1==t,r=2==t,i=3==t,o=4==t,a=6==t,s=5==t||a,u=e||an;return function(e,c,l){for(var f,h,d=mt(e),p=W(d),v=b(c,l,3),y=V(p.length),g=0,m=n?u(e,y):r?u(e,0):void 0;y>g;g++)if((s||g in p)&&(f=p[g],h=v(f,g,d),t))if(n)m[g]=h;else if(h)switch(t){case 3:return!0;case 5:return f;case 6:return g;case 2:m.push(f)}else if(o)return!1;return a?-1:i||o?o:m}}(0),cn=function(t,e,n,r,i,o){var a=y[t],s=a,u=i?"set":"add",c=s&&s.prototype,l={};return A&&"function"==typeof s&&(o||c.forEach&&!E(function(){(new s).entries().next()}))?(s=e(function(e,n){Wt(e,s,t,"_c"),e._c=new a,void 0!=n&&Jt(n,i,e[u],e)}),un("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in c&&(!o||"clear"!=t)&&O(s.prototype,t,function(n,r){if(Wt(this,s,t),!e&&o&&!w(n))return"get"==t&&void 0;var i=this._c[t](0===n?0:n,r);return e?this:i})}),o||sn(s.prototype,"size",{get:function(){return this._c.size}})):(s=r.getConstructor(e,t,i,u),ye(s.prototype,n),Ye.NEED=!0),yt(s,t),l[t]=s,P(P.G+P.W+P.F,l),o||r.setStrong(s,t,i),s},ln=(cn("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return nn.def(Xe(this,"Set"),t=0===t?0:t,t)}},nn),function(t){return function(){if(Gt(this)!=t)throw TypeError(t+"#toJSON isn't generic");return function(t,e){var n=[];return Jt(t,!1,n.push,n,e),n}(this)}});P(P.P+P.R,"Set",{toJSON:ln("Set")});var fn=function(t){P(P.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})};fn("Set");var hn=function(t){P(P.S,t,{from:function(t){var e,n,r,i,o=arguments[1];return m(this),(e=void 0!==o)&&m(o),void 0==t?new this:(n=[],e?(r=0,i=b(o,arguments[2],2),Jt(t,!1,function(t){n.push(i(t,r++))})):Jt(t,!1,n.push,n),new this(n))}})};hn("Set");var dn=g.Set,pn=t(e(function(t){t.exports={default:dn,__esModule:!0}})),vn=new AFRAME.THREE.Vector3,yn=new AFRAME.THREE.Quaternion,gn=new AFRAME.THREE.Vector3;AFRAME.registerSystem("poly-service",{schema:{key:{type:"string"}},init:function(){this.pages=[],this.loader=new AFRAME.THREE.FileLoader,this.query="https://poly.googleapis.com/v1/assets/?format=GLTF2&maxComplexity=SIMPLE&pageSize=20&key="+this.data.key},getListing:function(){var t=Ue(f.mark(function t(e){var r,i,o,a,s;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("attemping grab of page",e),!(e<0)){t.next=3;break}throw new Error("Requested page ("+e+") before beginning");case 3:if(!this.pages[e]){t.next=7;break}return t.abrupt("return",this.pages[e]);case 7:if(0!==e){t.next=16;break}return t.next=10,n(this.query,this.loader);case 10:return r=t.sent,i=JSON.parse(r),this.pages.push(i),t.abrupt("return",i);case 16:return o={},t.prev=17,t.next=20,this.getListing(e-1);case 20:o=t.sent,t.next=27;break;case 23:throw t.prev=23,t.t0=t.catch(17),console.log(t.t0.stack),new Error("Requested page ("+e+") past end, no previous page");case 27:if(!o.nextPageToken){t.next=36;break}return t.next=30,n(this.query+"&pageToken="+o.nextPageToken,this.loader);case 30:return a=t.sent,s=JSON.parse(a),this.pages.push(s),t.abrupt("return",s);case 36:throw new Error("Requested page ("+e+") past end, no page token");case 37:case"end":return t.stop()}},t,this,[[17,23]])}));return function(e){return t.apply(this,arguments)}}(),fakeGetListing:function(){var t=Ue(f.mark(function t(e){var r;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n("testdata/listing.json",this.loader);case 2:return r=t.sent,t.abrupt("return",JSON.parse(r));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}),AFRAME.registerComponent("avr-visible",{schema:{type:"boolean",default:!1},init:function(){this.el.addEventListener("model-loaded",this.update.bind(this))},update:function(){var t=this;console.log("visible update:",this.data),this.el.object3D.traverse(function(e){return e.visible=t.data})}});AFRAME.registerComponent("hover-scale",{init:function(){var t=this;this.el.setAttribute("animation__hover",{startEvents:["hoverstart","mouseleave"],property:"scale",dir:"alternate",easing:"easeOutQuad",dur:200}),this.el.addEventListener("mouseenter",function(){var e=function(t,e){return e.map(function(e){return t[e]})}(t.el.getAttribute("scale"),["x","y","z"]),n=e.map(function(t){return 1.2*t});t.el.setAttribute("animation__hover",{from:e.join(" "),to:n.join(" ")}),t.el.emit("hoverstart")})}}),AFRAME.registerComponent("maintain-size",{schema:{type:"vec3"},init:function(){this.el.addEventListener("model-loaded",this.rescale.bind(this))},rescale:function(){this.el.setAttribute("position",{x:0,y:0,z:0}),this.el.setAttribute("scale",{x:1,y:1,z:1});var t=new AFRAME.THREE.Box3;t.setFromObject(this.el.object3D);var e=t.getSize(),n=this.el.object3D.worldToLocal(t.getCenter()),r=Math.min(this.data.x/e.x,this.data.y/e.y,this.data.z/e.z);this.el.setAttribute("scale",{x:r,y:r,z:r}),this.el.setAttribute("position",n.multiplyScalar(-r)),this.el.components.collision&&this.el.components.collision.updateTransform()}});var mn=[],bn=null;AFRAME.registerComponent("altspace-controls",{schema:{default:"right"},init:function(){var t=Ue(f.mark(function t(){var e,n=this;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.gamepad=null,this.parentInverse=(new THREE.Matrix4).getInverse(this.el.parentElement.object3D.matrixWorld),bn||(bn=o()),!(mn.length>0)){t.next=7;break}t.t0=mn,t.next=10;break;case 7:return t.next=9,bn;case 9:t.t0=t.sent;case 10:e=t.t0,this.gamepad=e.filter(function(t){return t.hand===n.data})[0],this.gamepad||console.log("No "+this.data+"-hand controller found");case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),tick:function(){this.gamepad&&(this.el.object3D.position.copy(this.gamepad.position).applyMatrix4(this.parentInverse),this.el.object3D.quaternion.copy(this.gamepad.rotation),!this.gripState&&this.gamepad.buttons[1].pressed?(this.gripState=!0,this.el.emit("gripdown",this.el,!1)):this.gripState&&!this.gamepad.buttons[1].pressed&&(this.gripState=!1,this.el.emit("gripup",this.el,!1)))}});var wn=new AFRAME.THREE.Matrix4;AFRAME.registerComponent("grabbable",{schema:{enabled:{default:!0}},init:function(){if(this.grabber=null,this.localTransform=new AFRAME.THREE.Matrix4,this._hoverStart=this.hoverStart.bind(this),this._pickup=this.pickup.bind(this),this._drop=this.drop.bind(this),this._hoverEnd=this.hoverEnd.bind(this),this.el.dataset.spawnedby&&this.el.dataset.spawnedto){var t=document.getElementById(this.el.dataset.spawnedby),e=document.getElementById(this.el.dataset.spawnedto);t.object3D.updateMatrixWorld(!0),this.el.object3D.updateMatrixWorld(!0),wn.getInverse(this.el.object3D.matrixWorld).multiply(t.object3D.matrixWorld),i(this.el,wn),this.pickup({detail:e}),this.el.removeAttribute("data-spawnedby"),this.el.removeAttribute("data-spawnedto")}},update:function(){this.data.enabled?(this.el.addEventListener("collision-start",this._hoverStart),this.el.addEventListener("collision-end",this._hoverEnd)):(this.el.removeEventListener("collision-start",this._hoverStart),this.el.removeEventListener("collision-end",this._hoverEnd))},hoverStart:function(t){t.detail.addEventListener("gripdown",this._pickup)},pickup:function(t){var e=t.detail;this.grabber=e,e.object3D.updateMatrixWorld(!0),this.el.object3D.updateMatrixWorld(!0),this.localTransform.getInverse(e.object3D.matrixWorld).multiply(this.el.object3D.matrixWorld),this.el.setAttribute("collision","kinematic",!0),e.addEventListener("gripup",this._drop)},drop:function(t){var e=t.detail;this.grabber===e&&(this.grabber=null,this.el.setAttribute("collision","kinematic",!1))},hoverEnd:function(t){t.detail.removeEventListener("gripdown",this._pickup)},tick:function(){this.grabber&&(this.grabber.object3D.updateMatrixWorld(!0),i(this.el,wn.getInverse(this.el.object3D.parent.matrixWorld).multiply(this.grabber.object3D.matrixWorld).multiply(this.localTransform)))}});var _n=function(t,e,n){e in t?L.f(t,e,k(0,n)):t[e]=n};P(P.S+P.F*!Se(function(t){}),"Array",{from:function(t){var e,n,r,i,o=mt(t),a="function"==typeof this?this:Array,s=arguments.length,u=s>1?arguments[1]:void 0,c=void 0!==u,l=0,f=Qt(o);if(c&&(u=b(u,s>2?arguments[2]:void 0,2)),void 0==f||a==Array&&qt(f))for(n=new a(e=V(o.length));e>l;l++)_n(n,l,c?u(o[l],l):o[l]);else for(i=f.call(o),n=new a;!(r=i.next()).done;l++)_n(n,l,c?zt(i,u,[r.value,l],!0):r.value);return n.length=l,n}});var En=g.Array.from,An=e(function(t){t.exports={default:En,__esModule:!0}});t(An);var xn=t(e(function(t,e){e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(An);e.default=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return(0,n.default)(t)}})),Sn=dt("iterator"),Mn=g.isIterable=function(t){var e=Object(t);return void 0!==e[Sn]||"@@iterator"in e||I.hasOwnProperty(Gt(e))},jn=e(function(t){t.exports={default:Mn,__esModule:!0}});t(jn);var Tn=t(e(function(t,e){function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(jn),i=n(Je);e.default=function(){return function(t,e){if(Array.isArray(t))return t;if((0,r.default)(Object(t)))return function(t,e){var n=[],r=!0,o=!1,a=void 0;try{for(var s,u=(0,i.default)(t);!(r=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}));cn("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=nn.getEntry(Xe(this,"Map"),t);return e&&e.v},set:function(t,e){return nn.def(Xe(this,"Map"),0===t?0:t,e)}},nn,!0);P(P.P+P.R,"Map",{toJSON:ln("Map")}),fn("Map"),hn("Map");var Ln=g.Map,kn=t(e(function(t){t.exports={default:Ln,__esModule:!0}})),On=t(e(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}}));P(P.S+P.F*!A,"Object",{defineProperty:L.f});var Rn=g.Object,Fn=function(t,e,n){return Rn.defineProperty(t,e,n)},Pn=e(function(t){t.exports={default:Fn,__esModule:!0}});t(Pn);var Cn=t(e(function(t,e){e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(Pn);e.default=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,n.default)(t,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()})),Dn=function(){function t(){On(this,t),this.aToB=new kn,this.bToA=new kn}return Cn(t,[{key:"set",value:function(t,e){var n=this.bToA.get(e),r=this.aToB.get(t);n===t&&r===e||(this.aToB.delete(n),this.bToA.delete(r)),this.aToB.set(t,e),this.bToA.set(e,t)}},{key:"getB",value:function(t){return this.aToB.get(t)}},{key:"getA",value:function(t){return this.bToA.get(t)}},{key:"forEach",value:function(t){return this.bToA.forEach(t)}},{key:"deleteA",value:function(t){this.aToB.get(t)&&(this.bToA.delete(this.aToB.get(t)),this.aToB.delete(t))}},{key:"deleteB",value:function(t){this.bToA.get(t)&&(this.aToB.delete(this.bToA.get(t)),this.bToA.delete(t))}}]),t}(),Bn=e(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),In=e(function(t){var e=t.exports={version:"2.5.3"};"number"==typeof __e&&(__e=e)}),Nn=(In.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),Gn=function(t){if(!Nn(t))throw TypeError(t+" is not an object!");return t},Wn=function(t){try{return!!t()}catch(t){return!0}},zn=!Wn(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),Hn=Bn.document,Vn=Nn(Hn)&&Nn(Hn.createElement),qn=!zn&&!Wn(function(){return 7!=Object.defineProperty(function(t){return Vn?Hn.createElement(t):{}}("div"),"a",{get:function(){return 7}}).a}),Un=Object.defineProperty,Qn={f:zn?Object.defineProperty:function(t,e,n){if(Gn(t),e=function(t,e){if(!Nn(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!Nn(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!Nn(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!Nn(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),Gn(n),qn)try{return Un(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},Jn=zn?function(t,e,n){return Qn.f(t,e,function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}(1,n))}:function(t,e,n){return t[e]=n,t},Kn={}.hasOwnProperty,Yn=function(t,e){return Kn.call(t,e)},Xn=0,Zn=Math.random(),$n=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++Xn+Zn).toString(36))},tr=e(function(t){var e=$n("src"),n=Function.toString,r=(""+n).split("toString");In.inspectSource=function(t){return n.call(t)},(t.exports=function(t,n,i,o){var a="function"==typeof i;a&&(Yn(i,"name")||Jn(i,"name",n)),t[n]!==i&&(a&&(Yn(i,e)||Jn(i,e,t[n]?""+t[n]:r.join(String(n)))),t===Bn?t[n]=i:o?t[n]?t[n]=i:Jn(t,n,i):(delete t[n],Jn(t,n,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[e]||n.call(this)})}),er=function(t,e,n){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},nr=function(t,e,n){var r,i,o,a,s=t&nr.F,u=t&nr.G,c=t&nr.S,l=t&nr.P,f=t&nr.B,h=u?Bn:c?Bn[e]||(Bn[e]={}):(Bn[e]||{}).prototype,d=u?In:In[e]||(In[e]={}),p=d.prototype||(d.prototype={});u&&(n=e);for(r in n)o=((i=!s&&h&&void 0!==h[r])?h:n)[r],a=f&&i?er(o,Bn):l&&"function"==typeof o?er(Function.call,o):o,h&&tr(h,r,o,t&nr.U),d[r]!=o&&Jn(d,r,a),l&&p[r]!=o&&(p[r]=o)};Bn.core=In,nr.F=1,nr.G=2,nr.S=4,nr.P=8,nr.B=16,nr.W=32,nr.U=64,nr.R=128;var rr=nr,ir={}.toString,or=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==function(t){return ir.call(t).slice(8,-1)}(t)?t.split(""):Object(t)},ar=function(t){return or(function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}(t))},sr=Math.ceil,ur=Math.floor,cr=function(t){return isNaN(t=+t)?0:(t>0?ur:sr)(t)},lr=Math.min,fr=Math.max,hr=Math.min,dr="__core-js_shared__",pr=Bn[dr]||(Bn[dr]={}),vr=e(function(t){var e=function(t){return pr[t]||(pr[t]={})}("wks"),n=Bn.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:$n)("Symbol."+t))}).store=e})("unscopables"),yr=Array.prototype;void 0==yr[vr]&&Jn(yr,vr,{});var gr=function(t){return function(e,n,r){var i,o=ar(e),a=function(t){return t>0?lr(cr(t),9007199254740991):0}(o.length),s=function(t,e){return(t=cr(t))<0?fr(t+e,0):hr(t,e)}(r,a);if(t&&n!=n){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((t||s in o)&&o[s]===n)return t||s||0;return!t&&-1}}(!0);rr(rr.P,"Array",{includes:function(t){return gr(this,t,arguments.length>1?arguments[1]:void 0)}}),function(t){yr[vr][t]=!0}("includes");In.Array.includes;var mr=function(){function t(){On(this,t),this._pools={},this._refs=new kn}return Cn(t,[{key:"get",value:function(t){this._pools[t]=this._pools[t]||[];var e=this._pools[t].shift()||new Ammo[t];return this._refs.set(e,t),e}},{key:"getSome",value:function(t,e){for(var n=[],r=0;r<e;r++)n.push(this.get(t));return n}},{key:"done",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){var n=t._refs.get(e);t._pools[n]=t._pools[n]||[],t._pools[n].push(e)})}}]),t}();AFRAME.registerSystem("collision",{init:function(){var t=this;this.el2co=new Dn,this.el2localBounds=new kn,this.regQueue=[],this.manifolds=new pn,this.forceUpdateObjects=new pn,this._debugMeshes=new kn,this.ap=new mr,Ammo().then(function(){var e=new Ammo.btDefaultCollisionConfiguration,n=new Ammo.btCollisionDispatcher(e),r=t.ap.getSome("btVector3",2),i=Tn(r,2),o=i[0],a=i[1];o.setValue(-100,-100,-100),a.setValue(100,100,100);var s=new Ammo.btAxisSweep3(o,a);t.world=new Ammo.btCollisionWorld(n,s,e),t.ap.done(o,a),t.regQueue.forEach(function(e){return t.registerCollisionBody(e)}),t.regQueue=null})},tick:function(){var t=this;if(this.world){this.el2co.forEach(function(e,n){try{if(!t.forceUpdateObjects.has(e)&&!e.getAttribute("collision").kinematic)return;e.object3D.updateMatrixWorld(!0);var r=t.el2localBounds.get(e),i=e.object3D.localToWorld(r.getCenter()),o=e.object3D.getWorldQuaternion(),a=e.object3D.getWorldScale(),s=n.getWorldTransform(),u=n.getCollisionShape(),c=t.ap.getSome("btVector3",2),l=Tn(c,2),f=l[0],h=l[1],d=t.ap.get("btQuaternion");if(f.setValue.apply(f,xn(i.toArray())),d.setValue.apply(d,xn(o.toArray())),h.setValue.apply(h,xn(a.toArray())),s.setOrigin(f),s.setRotation(d),u.setLocalScaling(h),t.ap.done(f,d,h),t.forceUpdateObjects.delete(e),t.el.sceneEl.hasAttribute("debug")&&t._debugMeshes.has(e)){var p=t._debugMeshes.get(e);p.position.copy(i),p.quaternion.copy(o),p.scale.copy(a)}}catch(t){console.error("xfrm update failed:",err,e)}}),this.world.performDiscreteCollisionDetection();for(var e=this.world.getDispatcher(),n=e.getNumManifolds(),i=new pn,o=0;o<n;o++){var a=e.getManifoldByIndexInternal(o);a.getNumContacts()>0&&i.add(a)}try{var s=r(i,this.manifolds),u=!0,c=!1,l=void 0;try{for(var f,h=Ke(s);!(u=(f=h.next()).done);u=!0){var d=f.value,p=d.getBody0(),v=d.getBody1(),y=this.el2co.getA(p),g=this.el2co.getA(v);if(y&&g){var m=y.getAttribute("collision").with,b=g.getAttribute("collision").with;m.includes(g)&&b.includes(y)&&(g.emit("collision-start",y,!1),y.emit("collision-start",g,!1))}}}catch(t){c=!0,l=t}finally{try{!u&&h.return&&h.return()}finally{if(c)throw l}}}catch(t){console.error("coll-start failed:",t)}try{var w=r(this.manifolds,i),_=!0,E=!1,A=void 0;try{for(var x,S=Ke(w);!(_=(x=S.next()).done);_=!0){var M=x.value,j=M.getBody0(),T=M.getBody1(),L=this.el2co.getA(j),k=this.el2co.getA(T);if(L&&k){var O=[].concat(xn(L.getAttribute("collision").with)),R=[].concat(xn(k.getAttribute("collision").with));O.includes(k)&&R.includes(L)&&(k.emit("collision-end",L,!1),L.emit("collision-end",k,!1))}}}catch(t){E=!0,A=t}finally{try{!_&&S.return&&S.return()}finally{if(E)throw A}}}catch(t){console.error("coll-start failed:",t)}this.manifolds=i}},registerCollisionBody:function(t){if(this.world){var e=new AFRAME.THREE.Box3;e.setFromObject(t.object3DMap.mesh);var n=(new THREE.Matrix4).getInverse(t.object3D.matrixWorld);e.applyMatrix4(n),this.el2localBounds.set(t,e);var r=e.getSize(),i=new Ammo.btVector3(r.x/2,r.y/2,r.z/2),o=new Ammo.btCollisionObject;if(o.setCollisionShape(new Ammo.btBoxShape(i)),this.el2co.set(t,o),this.world.addCollisionObject(o),this.el.sceneEl.hasAttribute("debug")){var a=new THREE.Mesh(new THREE.BoxBufferGeometry(r.x,r.y,r.z),new THREE.MeshBasicMaterial({color:"magenta",transparent:!0,opacity:.2}));this._debugMeshes.set(t,a),this.el.sceneEl.object3D.add(a)}}else this.regQueue.push(t)},removeCollisionBody:function(t){var e=this.el2co.getB(t);this.world.removeCollisionObject(e),this.el2co.deleteA(t),this.el.sceneEl.hasAttribute("debug")&&(this.el.sceneEl.object3D.remove(this._debugMeshes.get(t)),this._debugMeshes.delete(t))},isRegistered:function(t){return!!this.el2co.getB(t)},forceUpdateTransform:function(t){this.forceUpdateObjects.add(t)}}),AFRAME.registerComponent("collision",{schema:{with:{default:[],parse:function(t){if(!t)return null;if("string"!=typeof t)return t;var e=t.split(",").map(function(t){return t+"[collision]"}).join(",");return Array.prototype.slice.call(document.querySelectorAll(e),0)}},kinematic:{type:"boolean",default:!1}},init:function(){this.el.object3DMap.mesh&&this.updateBounds(),this.el.addEventListener("model-loaded",this.updateBounds.bind(this))},update:function(t){if(t.kinematic&&!this.data.kinematic&&this.system.forceUpdateTransform(this.el),!function(t,e){return t&&e&&t.length===e.length&&t.every(function(t,n){return t===e[n]})}(t.with,this.data.with)){var e=!0,n=!1,r=void 0;try{for(var i,o=Ke(this.data.with);!(e=(i=o.next()).done);e=!0){var a=i.value;a!==this.el&&a.components&&a.components.collision&&a.components.collision.updateProperties()}}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}}},updateBounds:function(){this.system.isRegistered(this.el)&&this.system.removeCollisionBody(this.el),this.system.registerCollisionBody(this.el),this.updateTransform()},updateTransform:function(){this.system.forceUpdateTransform(this.el)},remove:function(){this.system.removeCollisionBody(this.el)}}),AFRAME.registerComponent("grab-indicator",{init:function(){var t=this;this.el.setAttribute("color","white"),this.el.addEventListener("collision-start",function(){t.el.setAttribute("color","yellow")}),this.el.addEventListener("collision-end",function(){t.el.setAttribute("color","white")})}}),AFRAME.registerComponent("spawner",{schema:{enabled:{default:!0},spawnTarget:{type:"selector",default:"#decorations"}},init:function(){this._hoverStart=this.hoverStart.bind(this),this._hoverEnd=this.hoverEnd.bind(this),this.handlers=new kn},update:function(){if(this.data.enabled)this.el.addEventListener("collision-start",this._hoverStart),this.el.addEventListener("collision-end",this._hoverEnd);else{this.el.removeEventListener("collision-start",this._hoverStart),this.el.removeEventListener("collision-end",this._hoverEnd);var t=!0,e=!1,n=void 0;try{for(var r,i=Ke(this.handlers);!(t=(r=i.next()).done);t=!0){var o=r.value,a=Tn(o,2),s=a[0];a[1];this.hoverEnd({detail:s})}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}},hoverStart:function(t){var e=t.detail,n=this.spawn(e);this.handlers.set(e,n),e.addEventListener("gripdown",n)},spawn:function(t){var e=this;return function(){var n=document.createElement("a-entity");n.setAttribute("mixin","decoration model"),n.setAttribute("data-src",e.el.getAttribute("gltf-model")),n.setAttribute("data-spawnedby",e.el.id),n.setAttribute("data-spawnedto",t.id),e.data.spawnTarget.appendChild(n),e.el.setAttribute("spawner","enabled",!1)}},hoverEnd:function(t){var e=t.detail;e.removeEventListener("gripdown",this.handlers.get(e)),this.handlers.delete(e),this.el.setAttribute("spawner","enabled",!0)}}),AFRAME.registerComponent("set-from-data",{schema:{from:{type:"string"},to:{type:"array"}},multiple:!0,update:function(){var t;(t=this.el).setAttribute.apply(t,xn(this.data.to).concat([this.el.dataset[this.data.from]]))}}),AFRAME.registerComponent("quaternion",{schema:{type:"vec4"},update:function(){var t=(new AFRAME.THREE.Euler).setFromQuaternion(this.data,"YZX").toVector3().multiplyScalar(180/Math.PI);this.el.setAttribute("rotation",t)}})}();
//# sourceMappingURL=bundle.min.js.map
//# sourceMappingURL=bundle.min.js.map
